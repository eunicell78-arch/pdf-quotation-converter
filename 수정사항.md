# 변환기 수정 사항

## 수정 완료된 항목

### 1. ✅ L/T 병합 셀 공란 문제 해결

**문제:** 
- Item, Product, MOQ가 병합된 셀일 때 (여러 Delivery Term이 있는 경우)
- L/T 값이 일부 행에서 공란으로 표시됨

**해결:**
- `extract_table_data()` 함수 수정
- `current_lt` 변수 추가하여 L/T 값 추적
- 병합된 셀의 L/T 값을 다음 행에도 반복해서 채움

**결과:**
```csv
Product,                     Delivery Term,        L/T
NACS Charging Cable_J3400,   FOB SH,              4-6  ✅
NACS Charging Cable_J3400,   DAP KR BY SEA/FERRY, 6-8  ✅
NACS Charging Cable_J3400,   DAP KR BY AIR,       4-6  ✅
```

### 2. ✅ NRE List 변환 지원 추가

**요구사항:**
- Product 칸 = Description 값
- Description 칸 = Cavity 정보 포함
- Delivery Term = "NRE List" 고정 표시
- MOQ = Qty 값
- Price = Unit Price만 사용 (Amount 제외)

**구현:**
- `extract_nre_list()` 함수 개선
  - Cavity 컬럼 감지 강화
  - Unit Price와 Amount 구분
  - Description에 Cavity 정보 통합
- `convert()` 함수 수정
  - NRE 항목을 올바른 형식으로 CSV에 추가

**NRE List 출력 형식:**
```csv
Date,Customer,Product,Description,Delivery Term,MOQ,Price,L/T,Remark
날짜,고객명,설명내용,"Cavity: 값",NRE List,수량,단가,리드타임,비고
```

## 추가 개선사항

### MOQ와 Remark 자동 처리
- MOQ가 "Sample"인 경우:
  - MOQ → "1"로 변환
  - Remark → "Sample"로 설정
- 기타 모든 병합 셀 값 반복 채우기

### 변경된 로직

**Before:**
```python
# MOQ가 있을 때만 행 추가
if moq and str(moq).strip():
    items.append(...)
```

**After:**
```python
# Price가 있을 때 행 추가 (더 정확)
# 모든 병합 값 추적 (item, product, delivery, moq, lt, remark)
if price and str(price).strip():
    items.append(...)
```

## 테스트 결과

샘플 PDF로 테스트:
- ✅ 3개 행 정확히 추출
- ✅ 모든 L/T 값 올바르게 채워짐
- ✅ MOQ "Sample" → "1" 변환 완료
- ✅ Remark "Sample" 유지
- ✅ 3개 Delivery Term 모두 정확히 추출

## 사용 방법

### CLI:
```bash
python converter.py input.pdf output.csv
```

### Streamlit:
```bash
streamlit run streamlit_app.py
```

PDF 업로드 → 자동 변환 → CSV/Excel 다운로드

## 주의사항

NRE List가 있는 PDF의 경우:
- NRE List 테이블에 "Cavity" 또는 "Description" + "Qty" 컬럼이 있어야 함
- Unit Price 컬럼이 있어야 함 (Amount는 무시됨)
- 자동으로 "NRE List" Delivery Term으로 표시됨
